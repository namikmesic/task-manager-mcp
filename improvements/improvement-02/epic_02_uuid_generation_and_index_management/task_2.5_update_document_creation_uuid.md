# Task 2.5: Update Document Creation Logic with UUIDs

**Parent Epic:** Epic 2: UUID Integration and Entity ID Management
**Status:** To Do

---

## 1. Objective & Scope

The objective of this task is to ensure that when new `Document` entities are created, their `id` fields are populated with version 4 UUIDs generated by the `_generateUUID()` utility (Task 2.1).

**Scope:**

- Modify the `TaskManager.createDocument()` method (which will be implemented as part of Epic 4, Task 4.1). If this method doesn't exist yet, this task might need to create a placeholder or anticipate its structure based on the `create_document` tool definition in `improvement-02.md`.
- Ensure the `id` field of the new `Document` object is assigned the result of `this._generateUUID()`.
- The `entity_id` field (linking to the parent Project, Epic, or Task) will already be a UUID.

## 2. Technical Purpose

To apply the new UUID generation standard to `Document` entities, ensuring they have unique, standardized identifiers and can be reliably linked to their parent entity (Project, Epic, or Task).

## 3. Contextual Relevance

This task extends UUID usage to the new `Document` primitive. As documents are universal and can be attached to any core entity, their unique identification is critical for managing project knowledge and context effectively.

## 4. Semantic Meaning

Assigning UUIDs to Documents at creation time establishes them as first-class, uniquely identifiable entities, reinforcing the new architecture's flexible approach to documentation and information management.

## 5. Detailed Implementation Guidance

1.  **Locate/Anticipate `TaskManager.createDocument()`:**

    - This method will be responsible for creating new `Document` objects. It will be implemented in Epic 4 (Task 4.1).
    - It will likely take parameters such as `title`, `content`, `type`, `entity_type`, `entity_id`, and `author` (as per `create_document` tool schema in `improvement-02.md`).
    - This task specifically focuses on the ID assignment part within that method.

2.  **Integrate `_generateUUID()`:**

    - When constructing the new `Document` object within `createDocument()`, assign its `id` property:
      ```typescript
      // Conceptual structure for createDocument method
      // async createDocument(docData: {
      //   title: string;
      //   content: string;
      //   type: string;
      //   entity_type: "project" | "epic" | "task";
      //   entity_id: string; // This will be a UUID of the parent
      //   author: string;
      // }): Promise<Document> {
      //   const newDocument: Document = {
      //     id: this._generateUUID(), // Use the new utility
      //     title: docData.title,
      //     content: docData.content,
      //     type: docData.type,
      //     entity_type: docData.entity_type,
      //     entity_id: docData.entity_id,
      //     author: docData.author,
      //   };
      //   // ... add to data.documents and saveData ...
      //   return newDocument;
      // }
      ```

3.  **Data Persistence:**

    - The `createDocument()` method will add this `newDocument` to the `documents` array in the in-memory `ProjectData` object and then call `this.saveData()`.

4.  **Return Value:** The method should return the newly created `Document` object.

## 6. Acceptance Criteria

- The `TaskManager.createDocument()` method correctly uses `this._generateUUID()` to assign the `id` for new `Document` entities.
- The generated ID is a valid UUID string.
- The new `Document` object, including its UUID, is correctly added to the `ProjectData.documents` array and persisted.
- The method returns the created `Document` object with its UUID.
- The code is clean, well-formatted, and type-safe.
- Commit message clearly describes the changes (e.g., `feat(TaskManager): Assign UUIDs to new Documents`).
