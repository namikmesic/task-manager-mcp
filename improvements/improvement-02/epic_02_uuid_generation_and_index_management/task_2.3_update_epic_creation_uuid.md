# Task 2.3: Update Epic Creation Logic with UUIDs

**Parent Epic:** Epic 2: UUID Integration and Entity ID Management
**Status:** To Do

---

## 1. Objective & Scope

The objective of this task is to ensure that when new `Epic` entities are created, their `id` fields are populated with version 4 UUIDs generated by the `_generateUUID()` utility (Task 2.1).

**Scope:**

- Modify the `TaskManager.createEpic()` or `TaskManager.createEpics()` method(s). The current system (from `docs/ai-onboarding.xml -> index.ts`) has a `createEpics` method that takes an array of epic details. This method will be refactored in Epic 6 (Task 6.2) to align with the new `Epic` interface.
- For each new `Epic` object being created, its `id` field must be assigned the result of `this._generateUUID()`.
- The `project_id` field (linking to the parent Project) will already be a UUID (assuming Project creation uses UUIDs).

## 2. Technical Purpose

To apply the new UUID generation standard to `Epic` entities, ensuring they have unique, standardized identifiers and can be reliably linked to their parent `Project`.

## 3. Contextual Relevance

This task continues the rollout of UUIDs to core entities. Correctly identifying Epics is crucial for structuring projects, linking Tasks, and managing dependencies.

## 4. Semantic Meaning

Assigning UUIDs to Epics at creation time further solidifies the adoption of standardized, robust identifiers throughout the project hierarchy.

## 5. Detailed Implementation Guidance

1.  **Locate/Anticipate `TaskManager.createEpic(s)`:**

    - The current `TaskManager` (from `docs/ai-onboarding.xml -> index.ts`) has `createEpics(epics: Array<{ prd_id: string; title: string; description: string; priority: 'low' | 'medium' | 'high'; }>): Promise<Epic[]>`.
    - This method will be refactored in Epic 6 (Task 6.2) to accept parameters aligning with the new `Epic` interface (e.g., `project_id`, `title`, and no `description` or `priority` but with `index`).
    - This task specifically focuses on changing the ID generation within that method.

2.  **Integrate `_generateUUID()`:**

    - Inside the loop or map function that creates new `Epic` objects (within `createEpics`), assign the `id` property:
      ```typescript
      // Conceptual change within the createEpics method
      // const newEpics = epicsData.map(e_input => ({
      //   id: this._generateUUID(), // Use the new utility
      //   project_id: e_input.project_id, // This should be a UUID from the parent project
      //   title: e_input.title,
      //   status: "todo", // Default status for new epics
      //   index: await this.getNextIndex('epic', e_input.project_id), // Anticipates Epic 3
      //   // No description, no priority, no created_at as per new Epic interface
      // }));
      ```

3.  **Data Persistence:**

    - The method will add these new `Epic` objects to the `epics` array in the in-memory `ProjectData` object and then call `this.saveData()`.

4.  **Return Value:** The method should return the array of newly created `Epic` objects.

5.  **Key Changes from Current `createEpics`:**
    - Replace `this.generateId('epic')` with `this._generateUUID()`.
    - Input parameters will change: `prd_id` becomes `project_id`. `description` and `priority` are removed. An `index` will be assigned (Epic 3).
    - The created `Epic` object will conform to the new `Epic` interface (no `description`, `priority`, `created_at`; has `project_id`, `status`, `index`).

## 6. Acceptance Criteria

- The `TaskManager.createEpic(s)` method correctly uses `this._generateUUID()` to assign the `id` for new `Epic` entities.
- The generated ID is a valid UUID string.
- The new `Epic` objects, including their UUIDs, are correctly added to the `ProjectData.epics` array and persisted.
- The method returns the created `Epic` object(s) with their UUIDs.
- The refactored method no longer uses the old `generateId('epic')`.
- The input parameters and the structure of the created `Epic` objects align with the new `Epic` interface as defined in `types.ts` and `improvement-02.md` (omitting description, priority, created_at, and using project_id, new status enum, index).
- The code is clean, well-formatted, and type-safe.
- Commit message clearly describes the changes (e.g., `feat(TaskManager): Assign UUIDs to new Epics`).
