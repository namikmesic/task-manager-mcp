# Task 2.4: Update Task Creation Logic with UUIDs

**Parent Epic:** Epic 2: UUID Integration and Entity ID Management
**Status:** To Do

---

## 1. Objective & Scope

The objective of this task is to ensure that when new `Task` entities are created, their `id` fields are populated with version 4 UUIDs generated by the `_generateUUID()` utility (Task 2.1).

**Scope:**

- Modify the `TaskManager.createTask()` or `TaskManager.createTasks()` method(s). The current system (from `docs/ai-onboarding.xml -> index.ts`) has a `createTasks` method that takes an array of task details. This method will be refactored in Epic 6 (Task 6.3) to align with the new `Task` interface.
- For each new `Task` object being created, its `id` field must be assigned the result of `this._generateUUID()`.
- The `epic_id` field (linking to the parent Epic) will already be a UUID.
- The `dependencies` field (array of Task UUIDs) will also contain UUIDs.

## 2. Technical Purpose

To apply the new UUID generation standard to `Task` entities, ensuring they have unique, standardized identifiers and can be reliably linked to their parent `Epic` and their task dependencies.

## 3. Contextual Relevance

This task continues the rollout of UUIDs to the most granular level of the core project entities. Correctly identifying Tasks is essential for detailed planning, assignment, status tracking, and dependency management.

## 4. Semantic Meaning

Assigning UUIDs to Tasks at creation time completes the adoption of standardized identifiers for the primary Project-Epic-Task hierarchy, supporting robust data relationships.

## 5. Detailed Implementation Guidance

1.  **Locate/Anticipate `TaskManager.createTask(s)`:**

    - The current `TaskManager` (from `docs/ai-onboarding.xml -> index.ts`) has `createTasks(tasks: Array<{ epic_id: string; title: string; description: string; priority: 'low' | 'medium' | 'high'; assignee?: string; due_date?: string; dependencies?: string[]; }>): Promise<Task[]>`.
    - This method will be refactored in Epic 6 (Task 6.3) to align with the new `Task` interface (e.g., `epic_id`, `title`, no `description` or `priority`, but with `index`, and `dependencies` which should already be an array of UUIDs).
    - This task specifically focuses on changing the ID generation within that method.

2.  **Integrate `_generateUUID()`:**

    - Inside the loop or map function that creates new `Task` objects (within `createTasks`), assign the `id` property:
      ```typescript
      // Conceptual change within the createTasks method
      // const newTasks = tasksData.map(t_input => ({
      //   id: this._generateUUID(), // Use the new utility
      //   epic_id: t_input.epic_id, // This should be a UUID from the parent epic
      //   title: t_input.title,
      //   status: "todo", // Default status for new tasks
      //   index: await this.getNextIndex('task', t_input.epic_id), // Anticipates Epic 3
      //   assignee: t_input.assignee,
      //   due_date: t_input.due_date,
      //   dependencies: t_input.dependencies || [], // Ensure it's an array of UUIDs
      //   // No description, no priority, no created_at/updated_at or notes as per new Task interface
      // }));
      ```

3.  **Data Persistence:**

    - The method will add these new `Task` objects to the `tasks` array in the in-memory `ProjectData` object and then call `this.saveData()`.

4.  **Return Value:** The method should return the array of newly created `Task` objects.

5.  **Key Changes from Current `createTasks`:**
    - Replace `this.generateId('task')` with `this._generateUUID()`.
    - Input parameters for each task will change: `description` and `priority` are removed. An `index` will be assigned (Epic 3). The `dependencies` array should already be designed to hold Task UUIDs as per `improvement-02.md`.
    - The created `Task` object will conform to the new `Task` interface (no `description`, `priority`, `created_at`, `updated_at`, `notes`; has `epic_id`, `status`, `index`, `assignee?`, `due_date?`, `dependencies?`).

## 6. Acceptance Criteria

- The `TaskManager.createTask(s)` method correctly uses `this._generateUUID()` to assign the `id` for new `Task` entities.
- The generated ID is a valid UUID string.
- The new `Task` objects, including their UUIDs, are correctly added to the `ProjectData.tasks` array and persisted.
- The method returns the created `Task` object(s) with their UUIDs.
- The refactored method no longer uses the old `generateId('task')`.
- The input parameters and the structure of the created `Task` objects align with the new `Task` interface as defined in `types.ts` and `improvement-02.md`.
- The code is clean, well-formatted, and type-safe.
- Commit message clearly describes the changes (e.g., `feat(TaskManager): Assign UUIDs to new Tasks`).
